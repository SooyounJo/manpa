.stage {
  position: fixed;
  inset: 0;
  z-index: 0;
  background: #000; /* black stage per spec */
  pointer-events: none; /* make purely decorative */
  width: 100vw;
  height: 100dvh; /* mobile viewport including dynamic bars */
  overflow: hidden;
  /* subtle upscaling for all waves */
  --startScale: 0.98;
  --endScale: 1.02; /* tweak here for stronger or weaker overall size */
}

.wave {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover; /* images are full-frame mobile comps */
  opacity: 0;
  /* default enter offset; overridden per-image via CSS vars */
  --enterX: 0;
  --enterY: 40px;
  --enterBlur: 6px;
  transform: translate3d(var(--enterX), var(--enterY), 0) scale(var(--startScale));
  filter: blur(var(--enterBlur));
  will-change: transform, opacity;
  image-rendering: auto;
  /* per-image animation tuning (overridable from inline styles) */
  --floatDur: 6000ms;
  --floatDelay: 0ms;
}

.visible {
  /* entrance then continuous float */
  animation:
    enter 1200ms ease-out forwards,
    floatXY var(--floatDur) ease-in-out calc(1200ms + var(--floatDelay)) infinite alternate;
}

.exit {
  animation: exitFade 700ms ease-in forwards;
}
.reenter {
  animation: reenter 900ms ease-out forwards;
}
.layer1 { z-index: 40; }
.layer2 { z-index: 30; }
.layer3 { z-index: 20; }
.layer4 { z-index: 10; }

@keyframes enter {
  from {
    opacity: 0;
    transform: translate3d(var(--enterX), var(--enterY), 0) scale(var(--startScale));
    filter: blur(var(--enterBlur));
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(var(--endScale));
    filter: blur(0px);
  }
}

@keyframes floatXY {
  /* start exactly where 'enter' ends to avoid any jump */
  0%   { transform: translate3d(0, 0, 0) scale(var(--endScale)); }
  50%  { transform: translate3d(4px, -3px, 0) scale(var(--endScale)); }
  100% { transform: translate3d(0, 0, 0) scale(var(--endScale)); }
}

@keyframes exitFade {
  from {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(var(--endScale));
  }
  to {
    opacity: 0;
    transform: translate3d(0, 0, 0) scale(var(--endScale));
  }
}

@keyframes reenter {
  from {
    opacity: 0;
    transform: translate3d(var(--exitX), var(--exitY), 0) scale(var(--endScale));
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(var(--endScale));
  }
}


